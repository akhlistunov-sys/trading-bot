services:
  - type: web
    name: ai-news-trader
    env: python
    region: frankfurt
    plan: free
    buildCommand: bash render_build.sh
    startCommand: python app.py
    autoDeploy: true
    envVars:
      # ==================== СИСТЕМНЫЕ ====================
      - key: PYTHON_VERSION
        value: 3.11.9  # ✅ ОБНОВЛЕНО ДО 3.11 для совместимости с библиотеками
      - key: PORT
        value: 10000
      
      # ==================== РЕЖИМ ====================
      - key: TRADING_MODE
        value: AGGRESSIVE_TEST
      - key: CHECK_INTERVAL_MINUTES
        value: 15
      
      # ==================== РИСК-МЕНЕДЖМЕНТ ====================
      - key: RISK_PER_TRADE
        value: 1.5
      - key: STOP_LOSS_PCT
        value: 1.5
      - key: TAKE_PROFIT_PCT
        value: 3.0
      - key: MAX_RISK_PER_TICKER
        value: 4.5
      - key: MAX_RISK_PER_SECTOR
        value: 12.0
      
      # ==================== АНАЛИЗ ====================
      - key: MIN_CONFIDENCE
        value: 0.6
      - key: MIN_IMPACT_SCORE
        value: 5
      
      # ==================== GIGACHAT (СЕКРЕТЫ) ====================
      - key: GIGACHAT_CLIENT_ID
        sync: false
      - key: GIGACHAT_CLIENT_SECRET
        sync: false
      - key: GIGACHAT_SCOPE
        value: GIGACHAT_API_PERS
      
      # ==================== GEMINI (СЕКРЕТ) ====================
      - key: GEMINI_API_KEY
        sync: false
      
      # ==================== TINKOFF (СЕКРЕТ) - ОПЦИОНАЛЬНО ====================
      - key: TINKOFF_API_TOKEN
        sync: false
        optional: true  # ✅ СДЕЛАНО ОПЦИОНАЛЬНЫМ
      
      # ==================== OPENROUTER (СЕКРЕТ) ====================
      - key: OPENROUTER_API_TOKEN
        sync: false
        optional: true  # ✅ СДЕЛАНО ОПЦИОНАЛЬНЫМ
      
      # ==================== FINAM (СЕКРЕТ) ====================
      - key: FINAM_API_TOKEN
        sync: false
        optional: true  # ✅ СДЕЛАНО ОПЦИОНАЛЬНЫМ
      - key: FINAM_CLIENT_ID
        value: 621971R9IP3
